{
	acme_dns cloudflare {env.CLOUDFLARE_API_TOKEN}
}

*.lucasduport.cc {
	@www host www.lucasduport.cc
	@nas host nas.lucasduport.cc
	@ldap host ldap.lucasduport.cc
	@tv host tv.lucasduport.cc
	@status host status.lucasduport.cc
	@resume host resume.lucasduport.cc
	@cv host cv.lucasduport.cc
	@lkdn host lkdn.lucasduport.cc
	@keycloak host keycloak.lucasduport.cc
	@configserver host config.lucasduport.cc

	handle @ldap {
		reverse_proxy {env.LDAP_TARGET}
	}
	handle @nas {
		reverse_proxy {env.NAS_TARGET}
	}
	handle @tv {
		reverse_proxy {env.TV_TARGET}
	}
	handle @status {
		reverse_proxy {env.STATUS_TARGET}
	}
	handle @keycloak {
		reverse_proxy {env.KEYCLOAK_TARGET} {
			header_up X-Forwarded-Proto https
			header_up X-Forwarded-For {remote_host}
			header_up X-Forwarded-Host {host}
			header_up Host {host}
		}
	}
	handle @configserver {
		reverse_proxy {env.CONFIG_SERVER_TARGET}
	}
	handle @resume {
		redir https://portfolio.lucasduport.cc/cvs/CV_EN_2025.pdf
	}
	handle @cv {
		redir https://portfolio.lucasduport.cc/cvs/CV_FR_2025.pdf
	}
	handle @lkdn {
		redir https://www.linkedin.com/in/lucas-duport/
	}

	# Default handler for this site
	handle {
		respond "404 Not Found" 404
	}
}

lucasduport.cc {
	redir https://portfolio.lucasduport.cc
}
